<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>KSPI Payment</title>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  body { background-color: #f8f9fa; }
  .fee-row { display:flex; justify-content:space-between; align-items:center; margin-bottom:5px; gap:5px; }
  .fee-row input[type=number] { width:100px; }
  .total-display { font-weight:bold; text-align:right; margin-top:5px; }
</style>
</head>
<body>

    <!-- Header Section -->
<div class="container-fluid bg-success bg-opacity-10 py-2">
  <div class="container">
    <div class="row align-items-center text-center text-md-start">
      <!-- Left: Two Logos -->
      <div class="col-12 col-md-4 d-flex justify-content-center justify-content-md-start align-items-center mb-2 mb-md-0">
        <a href="index.html" class="me-2">
          <img src="./img/logo-chang.png" alt="Logo 1" height="100" />
        </a>
        <a href="index.html">
          <img src="./img/logo-1.png" alt="Logo 2" height="60" />
        </a>
      </div>
      <!-- Center: Heading Text -->
      <div class="col-12 col-md-4 mb-2 mb-md-0">
        <h3 class="had-p m-0 fw-semibold text-danger">
          ৪ বছর মেয়াদী ডিপ্লোমা ইন ইঞ্জিনিয়ারিং কোর্সে ভর্তি চলিতেছে
        </h3>
      </div>
      <!-- Right: Buttons -->
      <div class="col-12 col-md-4 d-flex justify-content-center justify-content-md-end align-items-center gap-2">
        <a class="btn btn-primary" href="apply.html">Apply Now</a>
        <a class="btn btn-success" href="payment.html">Payment</a>
      </div>

    </div>
  </div>
</div>
<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
  <div class="container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="#ass">About</a></li>
        <li class="nav-item"><a class="nav-link" href="#us">Contact</a></li>
        <li class="nav-item"><a class="nav-link" href="#mag">Message</a></li>
        <li class="nav-item"><a class="nav-link" href="#dss">Gallery</a></li>
        <li class="nav-item"><a class="nav-link" href="login.html">Login</a></li>
        <!-- Admission Dropdown -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Admission</a>
          <ul class="dropdown-menu">
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#">Departments</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#">CST</a></li>
                <li><a class="dropdown-item" href="#">ET</a></li>
                <li><a class="dropdown-item" href="#">SUR</a></li>
                <li><a class="dropdown-item" href="#">CT</a></li>
              </ul>
            </li>
            <li><a class="dropdown-item" href="#">Tuition Fee</a></li>
            <li><a class="dropdown-item" href="#">Scholarship</a></li>
          </ul>
        </li>
        <li class="nav-item"><a class="nav-link" href="result.html">Result</a></li>
        <li class="nav-item"><a class="nav-link" href="notice.html">Notice</a></li>
        <li class="nav-item"><a class="nav-link" href="faculty.html">Faculty</a></li>
        <li class="nav-item"><a class="nav-link" href="StudentId.html">Students</a></li>
      </ul>
    </div>
  </div>
</nav>
  <!-- Navigation End -->

<div class="container mt-5">
  <div class="card shadow mx-auto" style="max-width:520px;">
    <div class="card-body">
      <h4 class="text-center mb-3">Student Payment</h4>
      <div id="successAlert" class="alert alert-success d-none mt-3" role="alert">
        <strong>✅ সফল!</strong><br>
        আপনার পেমেন্ট সফলভাবে সম্পন্ন হয়েছে।<br>
        রিসিপ্ট ডাউনলোড করা হয়েছে।
      </div>

      <form id="paymentForm">
        <div class="mb-2">
          <label>Student ID</label>
          <input type="text" id="studentId" class="form-control" placeholder="Enter ID">
        </div>
        <div class="mb-2">
          <label>Student Name</label>
          <input type="text" id="studentName" class="form-control" placeholder="Enter Name">
        </div>

        <div class="mb-3">
          <label>Select Fees & Enter Amount</label>
          <div class="fee-row">
            <input type="checkbox" class="feeCheck" value="Admission Fee" id="feeAdmission">
            <label for="feeAdmission">Admission Fee</label>
            <input type="number" class="feeAmount form-control" placeholder="Amount" disabled>
          </div>
         <div class="fee-row">
            <input type="checkbox" class="feeCheck" value="Form Fill-up Fee" id="feeForm">
            <label for="feeForm">Form Fill-up Fee</label>
            <input type="number" class="feeAmount form-control" placeholder="Amount" disabled>
          </div>
          <div class="fee-row">
            <input type="checkbox" class="feeCheck" value="Mid Exam Fee" id="feeMid">
            <label for="feeMid">Mid Exam Fee</label>
            <input type="number" class="feeAmount form-control" placeholder="Amount" disabled>
          </div>
          <div class="fee-row">
            <input type="checkbox" class="feeCheck" value="Final Exam Fee" id="feeFinal">
            <label for="feeFinal">Final Exam Fee</label>
            <input type="number" class="feeAmount form-control" placeholder="Amount" disabled>
          </div>
          <div class="fee-row">
            <input type="checkbox" class="feeCheck" value="Registration Fee" id="feeReg">
            <label for="feeReg">Registration Fee</label>
            <input type="number" class="feeAmount form-control" placeholder="Amount" disabled>
          </div>
          <div class="fee-row">
            <input type="checkbox" class="feeCheck" value="Library Fee" id="feeLib">
            <label for="feeLib">Library Fee</label>
            <input type="number" class="feeAmount form-control" placeholder="Amount" disabled>
          </div>
          <div class="fee-row">
            <input type="checkbox" class="feeCheck" value="Laboratory Fee" id="feeLab">
            <label for="feeLab">Laboratory Fee</label>
            <input type="number" class="feeAmount form-control" placeholder="Amount" disabled>
          </div>
          <div class="fee-row">
            <input type="checkbox" class="feeCheck" value="Development Fee" id="feeDev">
            <label for="feeDev">Development Fee</label>
            <input type="number" class="feeAmount form-control" placeholder="Amount" disabled>
          </div>
          <div class="fee-row">
            <input type="checkbox" class="feeCheck" value="Tuition Fee" id="feeTuition">
            <label for="feeTuition">Tuition Fee</label>
            <input type="number" class="feeAmount form-control" placeholder="Amount" disabled>
          </div>
          <div class="fee-row">
            <input type="checkbox" class="feeCheck" value="Testimonial Fee" id="feeTest">
            <label for="feeTest">Testimonial Fee</label>
            <input type="number" class="feeAmount form-control" placeholder="Amount" disabled>
          </div>
          <div class="total-display">
            Total: <span id="liveTotal">0.00</span> BDT
          </div>
        </div>

        <div class="mb-3">
          <label class="fee">Payment Method</label>
          <select class="form-select" id="paymentMethod" required>
            <option value="" selected disabled>Select Method</option>
            <option value="mobile">Mobile Banking</option>
            <option value="bank">Bank</option>
            <option value="cash">Cash</option>
          </select>
        </div>

        <div id="mobileSection" class="d-none">
          <div class="mb-2">
            <label class="fee">Mobile Banking Type</label>
            <select class="form-select" id="mobileType">
              <option value="" selected disabled>Select</option>
              <option value="bKash">bKash</option>
              <option value="Nagad">Nagad</option>
              <option value="Rocket">Rocket</option>
            </select>
          </div>
          <div class="alert alert-info d-none py-2" id="mobileNumber">Send money to: <strong>01728312408</strong></div>
          <div class="mb-2">
            <label class="fee">Transaction ID</label>
            <input type="text" id="mobileTrx" class="form-control">
          </div>
          <div class="mb-2">
            <label class="fee">Sender Number (Reference)</label>
            <input type="text" id="mobileSender" class="form-control">
          </div>
        </div>

        <div id="bankSection" class="d-none">
          <div class="mb-2">
            <label class="fee">Select Bank</label>
            <select class="form-select" id="bankName">
              <option value="" disabled selected>Select Bank</option>
              <option value="DBBL">DBBL</option>
              <option value="Islami Bank">Islami Bank</option>
              <option value="Sonali Bank">Sonali Bank</option>
            </select>
          </div>
          <div class="alert alert-info d-none py-2" id="bankAccount">College Account: <strong>01236547891232</strong></div>
          <div class="mb-2">
            <label class="fee">Transaction ID</label>
            <input type="text" id="bankTrx" class="form-control">
          </div>
          <div class="mb-2">
            <label class="fee">Sender Account (Reference)</label>
            <input type="text" id="bankSender" class="form-control">
          </div>
        </div>

        <button type="submit" class="btn btn-success w-100 mt-3">Submit Payment</button>
      </form>
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

  // Auto-fill from URL if available, but allow manual input

  const params = new URLSearchParams(window.location.search);
  const studentIdInput = document.getElementById("studentId");
  const studentNameInput = document.getElementById("studentName");
  if(params.get("id")) studentIdInput.value = params.get("id");
  if(params.get("name")) studentNameInput.value = params.get("name");

  const paymentMethod = document.getElementById("paymentMethod");
  const mobileSection = document.getElementById("mobileSection");
  const bankSection = document.getElementById("bankSection");
  const mobileType = document.getElementById("mobileType");
  const mobileNumber = document.getElementById("mobileNumber");
  const bankName = document.getElementById("bankName");
  const bankAccount = document.getElementById("bankAccount");
  const form = document.getElementById("paymentForm");
  const liveTotal = document.getElementById("liveTotal");

  // Enable/Disable fee amounts
  document.querySelectorAll(".feeCheck").forEach((check,index)=>{
    const amountInput = document.querySelectorAll(".feeAmount")[index];
    check.addEventListener("change",()=>{ amountInput.disabled = !check.checked; if(!check.checked) amountInput.value=""; updateTotal();});
    amountInput.addEventListener("input",updateTotal);
  });

  function updateTotal(){
    let total=0;
    document.querySelectorAll(".feeCheck").forEach((check,i)=>{ if(check.checked){ total += parseFloat(document.querySelectorAll(".feeAmount")[i].value)||0;}});
    liveTotal.innerText = total.toFixed(2);
  }

  paymentMethod.addEventListener("change",()=>{
    mobileSection.classList.add("d-none");
    bankSection.classList.add("d-none");
    if(paymentMethod.value === "mobile") mobileSection.classList.remove("d-none");
    else if(paymentMethod.value === "bank") bankSection.classList.remove("d-none");
  });
  mobileType.addEventListener("change",()=> mobileNumber.classList.remove("d-none"));
  bankName.addEventListener("change",()=> bankAccount.classList.remove("d-none"));

  form.addEventListener("submit", e=>{
    e.preventDefault();
    const studentId = studentIdInput.value.trim();
    const studentName = studentNameInput.value.trim();
    if(!studentId || !studentName){ alert("Student ID এবং Name অবশ্যই দিতে হবে"); return; }

    const method = paymentMethod.value;
    let paymentType="", transaction="", sender="";
    if(method==="mobile"){
      paymentType = mobileType.value.trim(); transaction=document.getElementById("mobileTrx").value.trim(); sender=document.getElementById("mobileSender").value.trim();
      if(!paymentType||!transaction||!sender){ alert("মোবাইল ব্যাংকিং এর সব তথ্য পূরণ করুন"); return; }
    } else if(method==="bank"){
      paymentType = bankName.value.trim(); transaction=document.getElementById("bankTrx").value.trim(); sender=document.getElementById("bankSender").value.trim();
      if(!paymentType||!transaction||!sender){ alert("ব্যাংকের সব তথ্য পূরণ করুন"); return; }
    } else if(method==="cash"){
      paymentType="Cash"; transaction="N/A"; sender="N/A";
    } else { alert("Payment Method select করুন"); return; }

    const selectedFees=[]; let totalAmount=0;
    const feeCheckboxes=document.querySelectorAll(".feeCheck");
    const feeAmounts=document.querySelectorAll(".feeAmount");
    for(let i=0;i<feeCheckboxes.length;i++){ if(feeCheckboxes[i].checked){ const amt=parseFloat(feeAmounts[i].value.trim()); if(isNaN(amt)||amt<=0){ alert(`Enter valid amount for ${feeCheckboxes[i].value}`); return; } selectedFees.push({name:feeCheckboxes[i].value,amount:amt.toFixed(2)}); totalAmount+=amt;}}
    if(selectedFees.length===0){ alert("কমপক্ষে একটি ফি select করুন"); return; }

    let payments = JSON.parse(localStorage.getItem("payments")||"[]");
    if(payments.some(p=>p.transaction===transaction && transaction!="N/A")){ alert("Duplicate Transaction ID! ইতিমধ্যে submit করা হয়েছে।"); return; }
    payments.push({studentId, studentName, method: method==="mobile"?"Mobile Banking":method==="bank"?"Bank":"Cash", paymentType, transaction, sender, totalAmount, fees:selectedFees, date:new Date().toLocaleString()});
    localStorage.setItem("payments",JSON.stringify(payments));

    // PDF generation (same as previous example)
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const pageWidth = doc.internal.pageSize.getWidth();
    let y=20;
    doc.setFontSize(16); doc.text("Kirtankhola Survey & Polytechnic Institute, Barishal", pageWidth/2,y,null,null,"center"); y+=10;
    doc.setLineWidth(0.5); doc.line(20,y,pageWidth-20,y); y+=10;

    const infoData=[ ["Student Name",studentName],["Student ID",studentId],["Payment Method",method],["Type/Bank",paymentType],["Transaction ID",transaction],["Sender Number/Account",sender],["Date",new Date().toLocaleString()] ];
    doc.setFont(undefined,"bold"); doc.text("Field",20,y); doc.text("Information",pageWidth/2+10,y); doc.setFont(undefined,"normal"); y+=7; doc.line(20,y,pageWidth-20,y); y+=5;
    infoData.forEach(row=>{doc.text(row[0],20,y); doc.text(row[1],pageWidth/2+10,y); y+=7;}); y+=10;

    doc.setFont(undefined,"bold"); doc.text("Fee Type",20,y); doc.text("Amount (BDT)",pageWidth-20,y,null,null,"right"); doc.setFont(undefined,"normal"); y+=5; doc.line(20,y,pageWidth-20,y); y+=7;
    selectedFees.forEach(f=>{if(y>doc.internal.pageSize.getHeight()-30){doc.addPage(); y=20; doc.setFont(undefined,"bold"); doc.text("Fee Type",20,y); doc.text("Amount (BDT)",pageWidth-20,y,null,null,"right"); doc.setFont(undefined,"normal"); y+=7; doc.line(20,y,pageWidth-20,y); y+=7;} doc.text(f.name,20,y); doc.text(f.amount,pageWidth-20,y,null,null,"right"); y+=7;});
    y+=5; doc.setFont(undefined,"bold"); doc.line(20,y,pageWidth-20,y); y+=7;
    doc.text("Total Amount",20,y); doc.text(totalAmount.toFixed(2),pageWidth-20,y,null,null,"right");

    const sigY=y+20; doc.setFont(undefined,"normal"); doc.line(40,sigY,90,sigY); doc.text("Account Officer",65,sigY+5,null,null,"center"); doc.line(pageWidth-90,sigY,pageWidth-40,sigY); doc.text("Student Signature",pageWidth-65,sigY+5,null,null,"center");
    doc.save(`${studentId}_payment_receipt.pdf`);

    const alertBox = document.getElementById("successAlert"); alertBox.classList.remove("d-none"); setTimeout(()=>alertBox.classList.add("d-none"),5000);
    form.reset(); mobileSection.classList.add("d-none"); bankSection.classList.add("d-none"); updateTotal();
  });
});
</script>
<br>
<br>
     <!-- Emergency Hotline Section -->
    <div class="mb-4">
      <img src="./img/gov_hotline-min (1).jpg" alt="Emergency Hotline" class="img-fluid rounded shadow" style="max-height: 300px;" />
    </div>
<footer class="bg-dark text-white pt-4">
  <div class="container">
    <div class="row">

      <!-- Contact Info -->
      <div class="col-md-3 mb-4">
        <h5>Contact Us</h5>
        <p><strong>Address:</strong> Kirtankhola Survey & Polytechnic Institute,Barishal.</p>
        <p><strong>Phone:</strong> +8801728312408</p>
        <p><strong>Email:</strong> 
          <a href="mailto:dipto2512@gmail.com" class="text-white">dipto2512@gmail.com</a>
        </p>
      </div>

      <!-- Useful Links -->
      <div class="col-md-3 mb-4">
        <h5>Useful Links</h5>
        <ul class="list-unstyled">
          <li><a href="#" class="text-white">Admission</a></li>
          <li><a href="#" class="text-white">Faculty</a></li>
          <li><a href="#" class="text-white">Location</a></li>
        </ul>
      </div>

      <!-- Map -->
      <div class="col-md-3 mb-4">
        <h5>Location</h5>
        <div class="ratio ratio-4x3">
          <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3680.3344414410967!2d90.33776917385485!3d22.71580742770926!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x375537dc29b0c1a1%3A0x635ffa79b514d0ea!2z4KaV4KeA4Kaw4KeN4Kak4Kao4KaW4KeL4Kay4Ka-IOCmuOCmvuCmsOCnjeCmreCnhyAmIOCmquCmsuCmv-Cmn-Cnh-CmleCmqOCmv-CmlSDgpofgpqjgprjgp43gpp_gpr_gpp_gpr_gpongpp8!5e0!3m2!1sbn!2sbd!4v1746115245054!5m2!1sbn!2sbd" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        </div>
      </div>

      <!-- Social Links -->
      <div class="col-md-3 mb-4">
        <h5>Follow Us</h5>
        <ul class="list-unstyled d-flex gap-3 social-icons flex-wrap">
          <li><a href="#" target="_blank" class="text-white" title="Facebook"><i class="fab fa-facebook fa-lg"></i></a></li>
          <li><a href="#" target="_blank" class="text-white" title="YouTube"><i class="fab fa-youtube fa-lg"></i></a></li>
          <li><a href="#" target="_blank" class="text-white" title="Instagram"><i class="fab fa-instagram fa-lg"></i></a></li>
          <li><a href="3" target="_blank" class="text-white" title="LinkedIn"><i class="fab fa-linkedin fa-lg"></i></a></li>
          <li><a href="#" target="_blank" class="text-white" title="Twitter"><i class="fab fa-twitter fa-lg"></i></a></li>
          <li><a href="#" target="_blank" class="text-white" title="Telegram"><i class="fab fa-telegram fa-lg"></i></a></li>
          <li><a href="https://wa.me/8801XXXXXXXXX" target="_blank" class="text-white" title="WhatsApp"><i class="fab fa-whatsapp fa-lg"></i></a></li>
        </ul>
      </div>
    </div>

    <!-- Bottom Footer -->
    <div class="footer-bottom border-top">
      <div class="row align-items-center">
        <div class="col-md-12 text-center ">
          <p class="mb-0">&copy; 2025 Kirtankhola Survey & Polytechnic Institute,Barishal.</p>
        </div>
        <div class="col-md-12 text-center ">
          <small>Developed by <strong>Dipto-Das</strong></small>
        </div>
      </div>
    </div>
</footer>



</body>
</html>